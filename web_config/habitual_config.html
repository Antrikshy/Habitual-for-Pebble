<!DOCTYPE html>
<html>
  <head>
    <title>Habitual Configuration</title>
    <style>
      body {
        padding: 20px 0;
        text-align: center;
        font-family: "Helvetica Neue", "Arial", sans-serif;
        background-color: #2A2A2A;
        color: #FFFFFF;
      }
      input {
        margin: 10px;
        text-align: center;
        color: #2A2A2A;
      }
    </style>
  </head>
  <body>
    <h1>Set your habits</h1>
    <br/>
    <input id='habit1' type='text' placeholder='Habit 1' />
    <br/>
    <input id='habit2' type='text' placeholder='Habit 2' />
    <br/>
    <input id='habit3' type='text' placeholder='Habit 3' />
    <br/>
    <input id='habit4' type='text' placeholder='Habit 4' />
    <br/>
    <input id='habit5' type='text' placeholder='Habit 5' />
    <br/>
    <br/>
    <input id='submit_button' type='button' value='Save'>

    <script>
      var submitButton = document.getElementById('submit_button');

      submitButton.addEventListener('click', function() {
        // Make a data object to be sent
        var options = {
          'Habit1': document.getElementById('habit1').value,
          'Habit2': document.getElementById('habit2').value,
          'Habit3': document.getElementById('habit3').value,
          'Habit4': document.getElementById('habit4').value,
          'Habit5': document.getElementById('habit5').value
        };
        // Determine the correct return URL (emulator vs real watch)
        function getQueryParam(variable, defaultValue) {
          var query = location.search.substring(1);
          var vars = query.split('&');
          for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split('=');
            if (pair[0] === variable) {
              return decodeURIComponent(pair[1]);
            }
          }
          return defaultValue || false;
        }
        var return_to = getQueryParam('return_to', 'pebblejs://close#');
        // Encode and send the data when the page closes
        document.location = return_to + encodeURIComponent(JSON.stringify(options));
      });
    </script>
  </body>
</html>
